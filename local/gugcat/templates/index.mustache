{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template local_test/manage

    Example context (json):
    { }
}}
<div class="container">
    <h4 class="title">{{title}}</h4>
    <button class="tablink active" id="btn-assessment">{{assessmenttabstr}}</button>
    <button class="tablink" id="btn-overview">{{overviewtabstr}}</button>
    <button class="btn btn-default btn-approve">{{approvebtnstr}}</button>
    <div class="tabcontent tab-1">
        <div class="tabcontent-header">
            <div class="selectdiv">
                <select id="select-activity">
                    {{#activities}}
                    <option {{selected}} value={{id}} >{{name}}</option>
                    {{/activities}}
                </select>
            </div>
            <button id="saveaddbtn" class="btn btn-default btn-add">{{addallgrdstr}}</button>
            <button class="btn btn-default btn-download">Download .csv</button>
        </div>
         <div class="table-responsive">          
            <table id="gradecapturelist" class="table">
                <thead>
                    <tr>
                    {{#columns}}
                    <th>{{.}}</th>
                    {{/columns}}
                    <th class="togglemultigrd">
                        {{addallgrdstr}}
                    </th>
                    <th class="togglemultigrd">
                        {{reasonnewgrdstr}}
                    </th>
                    <th>Provisional Grade</th>
                    <th></th>
                    </tr>
                </thead>
                <tbody>
                    {{#rows}}
                    <tr>
                        <td>{{cnum}}</td>
                        <td>{{studentno}}</td>
                        <td>{{surname}}</td>
                        <td>{{forename}}</td>
                        <td>{{firstgrade}} <i class="fa fa-ellipsis-h"></i></td>
                        {{#grades}}
                            <td> 
                            {{grade}}<i class="fa fa-ellipsis-h"></i>
                            </td>
                        {{/grades}}
                        <td class="togglemultigrd">
                            <div class="selectdiv">
                                <select>
                                    <option>Choose grade</option>
                                </select>
                            </div>
                        </td>
                        <td class="togglemultigrd">
                            <div class="selectdiv">
                                <select>
                                    <option>Select reason</option>
                                </select>
                            </div>
                        </td>
                        <td><b>{{provisionalgrade}}</b></td>
                        <td><button class="btn btn-default btn-newgrade">Add Grade</button></td>
                    </tr>  
                    {{/rows}}
                </tbody>
            </table>
        </div>
    </div>
    <div class="tabcontent tab-2">
        <div class="tabcontent-header">
            <button class="btn btn-default btn-download">Download .csv</button>
            <br/><br/>
        </div>
        <div class="table-responsive">          
            <table class="table">
                <thead>
                    <tr class="tr-header">
                        <th scope="col" class="th-font">
                            Candidate <br/>&nbsp;&nbsp;No.
                        </th>
                        <th scope="col" class="th-font">
                            Student <br/>&nbsp;No.
                        </th>
                        <th scope="col" class="th-font">
                            Surname
                            <br/><br/>
                        </th>
                        <th scope="col" class="th-font">
                            Forename
                            <br/><br/>
                        </th>
                        <th scope="col" class="th-font">
                            Assignment 1:<br/>Critical Essay
                        </th>
                        <th scope="col" class="th-font">
                            Assignment 2: <br>Quiz
                        </th>
                        <th scope="col" class="th-font">
                            Exam 1
                            <br/><br/>
                        </th>
                        <th scope="col" class="th-font">
                            Exam 2
                            <br/><br/>
                        </th>
                        <th scope="col" class="th-font">
                            <span class="th-aggregate-grade">
                                Aggregate Grade &nbsp;&nbsp;
                                <i class="fa fa-cog" aria-hidden="true"></i>
                            </span>
                            <br/><br/>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {{#students}}
                    <tr>
                        <td>{{id}}</th>
                        <td>{{id}}</td>
                        <td>{{surname}}</td>
                        <td>{{forename}}</td>
                        <td>{{assignment1}}
                            <i class="fa fa-ellipsis-h ellipsis-h-color" aria-hidden="true" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></i>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item" href="#">Ammend Grades</a>
                                <a class="dropdown-item" href="#">Historical Ammendments</a>
                            </div>
                        </td>
                        <td>{{assignment2}} 
                            <i class="fa fa-ellipsis-h ellipsis-h-color" aria-hidden="true" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></i>
                        </td>
                        <td>{{exam1}} 
                            <i class="fa fa-ellipsis-h ellipsis-h-color" aria-hidden="true" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></i>
                        </td>
                        <td>{{exam2}}
                            <i class="fa fa-ellipsis-h ellipsis-h-color" aria-hidden="true" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></i>
                        </td>
                        <td class="td-9">
                            <span class="td-9-aggregate-grade">
                                {{aggregate_grade}} 
                                <i class="fa fa-ellipsis-h ellipsis-h-color" aria-hidden="true" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></i>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item" href="#">Ammend Grades</a>
                                    <a class="dropdown-item" href="#">Historical Ammendments</a>
                                </div>
                            </span>
                        </td>
                    </tr>
                    {{/students}}
                </tbody>
            </table>
        </div>
    </div>
</div>
{{#js}}
    $(function(){
        $("#select-activity").on("change", function () { 
            window.location.href = "index.php?activityid="+$("#select-activity").val();
        });

        $("#saveaddbtn").on("click", function(e) {
            e.preventDefault();
            $(this).toggleClass("togglebtn");
            if($(this).hasClass("togglebtn")){
                $(this).text("{{saveallbtnstr}}");    
            } else {
                $(this).text("{{addallgrdstr}}");
            }
            $(".togglemultigrd").toggle();
        });

        $(".btn-newgrade").click(function(){
            window.location.href="addgradeform.php";
        });
        
        $("#btn-assessment").click(function(){
            $("#btn-overview").removeClass("active");
            $(".tab-2").fadeOut();

            $(".btn-approve").show();

            $(this).addClass("active");
            $(".tab-1").fadeIn();
        });

        $("#btn-overview").click(function(){
            $("#btn-assessment").removeClass("active");
            $(".tab-1").fadeOut();
            
            $(".tab-2").css({
                "display": "block"
            });
            
            $(".btn-approve").hide();

            $(this).addClass("active");
            $(".tab-2").fadeIn();
        });
    });
{{/js}}



