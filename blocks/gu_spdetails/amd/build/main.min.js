define(["core/ajax"],function(t){const e=t=>{var e=document.getElementById("current_tab"),s=document.getElementById("past_tab"),c=document.getElementById("sortby_course"),r=document.getElementById("sortby_date"),d=document.getElementById("sortby_startdate"),n=document.getElementById("sortby_enddate");switch(t.target){case e:var o="current",i=0,l="coursetitle",u="asc";e.classList.add("active"),s.classList.remove("active"),a(o,i,l,u);break;case s:o="past",i=0,l="coursetitle",u="asc";e.classList.remove("active"),s.classList.add("active"),a(o,i,l,u);break;case c:if(e.classList.contains("active"))o="current";else o="past";i=0,l="coursetitle";"asc"==c.getAttribute("data-value")?(u="desc",c.setAttribute("data-value","desc"),c.classList.add("th-sort-desc"),c.classList.remove("th-sort-asc")):(u="asc",c.setAttribute("data-value","asc"),c.classList.add("th-sort-asc"),c.classList.remove("th-sort-desc")),a(o,i,l,u);break;case r:o="current",i=0,l="duedate";"asc"==r.getAttribute("data-value")?(u="desc",r.setAttribute("data-value","desc"),r.classList.add("th-sort-desc"),r.classList.remove("th-sort-asc")):(u="asc",r.setAttribute("data-value","asc"),r.classList.add("th-sort-asc"),r.classList.remove("th-sort-desc")),a(o,i,l,u);break;case d:o="past",i=0,l="startdate";"asc"==d.getAttribute("data-value")?(u="desc",d.setAttribute("data-value","desc"),d.classList.add("th-sort-desc"),d.classList.remove("th-sort-asc")):(u="asc",d.setAttribute("data-value","asc"),d.classList.add("th-sort-asc"),d.classList.remove("th-sort-desc")),a(o,i,l,u);break;case n:o="past",i=0,l="enddate";"asc"==n.getAttribute("data-value")?(u="desc",n.setAttribute("data-value","desc"),n.classList.add("th-sort-desc"),n.classList.remove("th-sort-asc")):(u="asc",n.setAttribute("data-value","asc"),n.classList.add("th-sort-asc"),n.classList.remove("th-sort-desc")),a(o,i,l,u)}},s=t=>{var e=document.getElementById("menu_current_assessments_sortby"),s=document.getElementById("menu_past_assessments_sortby"),c=document.getElementById("sortby_course"),r=document.getElementById("sortby_date"),d=document.getElementById("sortby_startdate"),n=document.getElementById("sortby_enddate");switch(t.target){case e:var o="current",i=0,l=e.value,u="asc";"coursetitle"===e.value?(c.classList.add("th-sort-asc"),c.classList.remove("th-sort-desc"),c.setAttribute("data-value","asc")):(r.classList.add("th-sort-asc"),r.classList.remove("th-sort-desc"),r.setAttribute("data-value","asc")),a(o,i,l,u);break;case s:o="past",i=0,l=s.value,u="asc";"coursetitle"===s.value?(c.classList.add("th-sort-asc"),c.classList.remove("th-sort-desc"),c.setAttribute("data-value","asc")):"startdate"===s.value?(d.classList.add("th-sort-asc"),d.classList.remove("th-sort-desc"),d.setAttribute("data-value","asc")):(n.classList.add("th-sort-asc"),n.classList.remove("th-sort-desc"),n.setAttribute("data-value","asc")),a(o,i,l,u)}},a=(e,s,a,n,o=null)=>{var i=document.getElementById("assessments-container"),l=document.getElementById("subcategory-container"),u=null===o?i:l,m=null===o?document.getElementById("assessments_details_contents"):document.getElementById("subcategory_details_contents");null===o?(i.classList.remove("hidden-container"),l.classList.add("hidden-container")):(i.classList.add("hidden-container"),l.classList.remove("hidden-container")),t.call([{methodname:"block_gu_spdetails_retrieve_assessments",args:{activetab:e,page:s,sortby:a,sortorder:n,subcategory:o}}])[0].done(function(t){m.innerHTML=t.result;var e=document.querySelectorAll(".subcategory-row");d(e),r(),c(a,n)}).fail(function(t){if(t){var e=document.createElement("div");if(e.classList.add("alert","alert-danger"),t.hasOwnProperty("message")){var s=document.createElement("p");s.innerHTML=t.message,e.appendChild(s),s.classList.add("errormessage")}if(t.hasOwnProperty("moreinfourl")){var a=document.createElement("p"),c=document.createElement("a");c.setAttribute("href",t.moreinfourl),c.setAttribute("target","_blank"),c.innerHTML="More information about this error",e.appendChild(a),a.appendChild(c),a.classList.add("errorcode")}u.prepend(e)}})},c=(t,e)=>{var s=document.getElementById("sortby_course"),a=document.getElementById("sortby_date"),c=document.getElementById("sortby_startdate"),r=document.getElementById("sortby_enddate");switch(t){case"coursetitle":s&&("asc"===e?(s.classList.add("th-sort-asc"),s.classList.remove("th-sort-desc"),s.setAttribute("data-value","asc")):(s.classList.add("th-sort-desc"),s.classList.remove("th-sort-asc"),s.setAttribute("data-value","desc")));break;case"duedate":a&&("asc"===e?(a.classList.add("th-sort-asc"),a.classList.remove("th-sort-desc"),a.setAttribute("data-value","asc")):(a.classList.add("th-sort-desc"),a.classList.remove("th-sort-asc"),a.setAttribute("data-value","desc")));break;case"startdate":c&&("asc"===e?(c.classList.add("th-sort-asc"),c.classList.remove("th-sort-desc"),c.setAttribute("data-value","asc")):(c.classList.add("th-sort-desc"),c.classList.remove("th-sort-asc"),c.setAttribute("data-value","desc")));break;case"enddate":r&&("asc"===e?(r.classList.add("th-sort-asc"),r.classList.remove("th-sort-desc"),r.setAttribute("data-value","asc")):(r.classList.add("th-sort-desc"),r.classList.remove("th-sort-asc"),r.setAttribute("data-value","desc")))}},r=()=>{document.querySelectorAll("#assessments_details_contents .page-item a.page-link").forEach(t=>{if("#"!==t.getAttribute("href")){var e=new URL(t.getAttribute("href")),s=new URLSearchParams(e.search),c=s.get("activetab"),r=s.get("page"),d=s.get("sortby"),n=s.get("sortorder");t.addEventListener("click",t=>{t.preventDefault(),a(c,r,d,n)})}else t.removeAttribute("href")})},d=t=>{t.length>0&&t.forEach(t=>{t.addEventListener("click",()=>(t=>{id=t.getAttribute("data-id"),subname=t.getAttribute("data-name"),course=t.getAttribute("data-course"),grade=t.getAttribute("data-grade"),weight=t.getAttribute("data-weight"),null!==id&&(a("current",0,"duedate","asc",id),document.getElementById("subcategory-details-course").innerHTML=course,document.getElementById("subcategory-details-weight").innerHTML=weight,document.getElementById("subcategory-details-grade").innerHTML=grade,document.getElementById("subcategory-details-name").innerHTML=subname,document.getElementById("subcategory-return-assessment").addEventListener("click",()=>{document.getElementById("assessments-container").classList.remove("hidden-container"),document.getElementById("subcategory-container").classList.add("hidden-container"),document.getElementById("subcategory_details_contents").innerHTML=""}))})(t))})};return{init:function(){const t=document.querySelector(".assessments-details-container");if(t){var c=document.getElementById("current_tab"),r=document.getElementById("past_tab");c.classList.add("active"),r.classList.remove("active"),a("current",0,"coursetitle","asc"),t.addEventListener("change",s),t.addEventListener("click",e)}}}});